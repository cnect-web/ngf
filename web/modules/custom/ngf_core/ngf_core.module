<?php

/**
 * @file
 * Contains ngf_core.module.
 */

use Drupal\Core\Routing\RouteMatchInterface;

/**
 * Implements hook_help().
 */
function ngf_core_help($route_name, RouteMatchInterface $route_match) {
  switch ($route_name) {
    // Main module help for the ngf_core module.
    case 'help.page.ngf_core':
      $output = '';
      $output .= '<h3>' . t('About') . '</h3>';
      $output .= '<p>' . t('Next Generation Futurium Core Functionality') . '</p>';
      return $output;
  }
}

/**
 * Alter the group menu.
 */
function ngf_core_group_operations_alter(&$links, $group) {
  // Move the Create Post action to top.
  if (isset($links['gnode-create-post'])) {
    $links['gnode-create-post']['weight']--;
  }

  // Modify the action link title.
  foreach ($links as $key => $link) {
    $link_title_arg = $link['title']->getArguments();
    if (isset($link_title_arg['@type'])) {
      $links[$key]['title'] = t('New @type', $link_title_arg);
    }
  }
}

/**
 * Implements hook_menu_alter().
 */
function ngf_core_link_alter(&$variables) {
  $url = $variables['url'];
  // Alter the login link text to "Sign In"
  if ($url->isRouted() && $url->getRouteName() == 'user.login') {
    $variables['text'] = t('Sign In');
  }
}

/**
 * Implements hook_form_FORM_ID_alter().
 */
function ngf_core_form_user_register_form_alter(&$form, \Drupal\Core\Form\FormStateInterface $form_state, $form_id) {
  // Alter the registration form button text to "Sign Up".
  if (isset($form['actions']['submit'])) {
    $form['actions']['submit']['#value'] = t('Sign Up');
  }

  // Add the legal agreements message.
  $form['agreements'] = [
    '#markup' => t("By clicking 'Sign up' or using one of the Social Auth Login buttons you agree to our <a href=\"/legal/terms-and-conditions\">Terms and Conditions</a> and that you have read our <a href=\"/legal/data-use-policy\">Data Use Policy</a>."),
    '#weight' => 99,
  ];


}
